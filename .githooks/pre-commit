#!/bin/bash

# コミット対象Swiftファイルを取得(1行で空白区切り）
stagedSwiftFiles=$(git diff --cached --name-only --diff-filter=ACMR | grep '\.swift$')

if xcrun --find swift-format >/dev/null && [ -n "$stagedSwiftFiles" ]; then
  xcrun swift-format format --in-place $stagedSwiftFiles
else
  echo "⚠️ swift-format が見つかりませんでした。"
  exit 0
fi

if ! git diff --quiet -- $stagedSwiftFiles; then
  echo ""
  echo "✨ swift-format によりファイルが修正されました。"
  echo "変更を確認し、もう一度コミットしてください。"
  echo ""
  echo "🔍 修正されたファイル:"
  git diff --stat
  exit 1
fi


